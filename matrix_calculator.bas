10 PRINT CHR$(147)
20 PRINT "***** MATRIX CALCULATOR *****"
30 PRINT "1=ADD  2=SUBTRACT  3=MULTIPLY  0=QUIT"

40 DIM A(10,10),B(10,10),RES(10,10)
50 INPUT "SELECT OPERATION ";O
60 IF O=0 THEN END
70 INPUT "NUMBER OF ROWS FOR MATRIX A: ";R1
80 INPUT "NUMBER OF COLUMNS FOR MATRIX A: ";C1
90 INPUT "NUMBER OF ROWS FOR MATRIX B: ";R2
100 INPUT "NUMBER OF COLUMNS FOR MATRIX B: ";C2

110 IF O=3 AND C1<>R2 THEN PRINT "ERROR: COLUMNS OF A MUST EQUAL ROWS OF B" : GOTO 50

120 PRINT "ENTER MATRIX A:"
130 FOR I=1 TO R1
140   FOR J=1 TO C1
150     PRINT "A(";I;",";J;") ";
160     INPUT A(I,J)
170   NEXT J
180 NEXT I

190 PRINT "ENTER MATRIX B:"
200 FOR I=1 TO R2
210   FOR J=1 TO C2
220     PRINT "B(";I;",";J;") ";
230     INPUT B(I,J)
240   NEXT J
250 NEXT I

260 PRINT
270 PRINT "MATRIX A:"
280 GOSUB 910
290 PRINT
300 PRINT "MATRIX B:"
310 GOSUB 920

320 IF O=1 THEN GOSUB 500
330 IF O=2 THEN GOSUB 600
340 IF O=3 THEN GOSUB 700
350 GOTO 50

500 REM --- ADDITION ---
510 FOR I=1 TO R1
520   FOR J=1 TO C1
530     RES(I,J)=A(I,J)+B(I,J)
540   NEXT J
550 NEXT I
560 PRINT : PRINT "RESULT OF ADDITION:"
570 GOSUB 930
580 RETURN

600 REM --- SUBTRACTION ---
610 FOR I=1 TO R1
620   FOR J=1 TO C1
630     RES(I,J)=A(I,J)-B(I,J)
640   NEXT J
650 NEXT I
660 PRINT : PRINT "RESULT OF SUBTRACTION:"
670 GOSUB 930
680 RETURN

700 REM --- MULTIPLICATION ---
710 FOR I=1 TO R1
720   FOR J=1 TO C2
730     SUM=0
740     FOR K=1 TO C1
750       SUM=SUM+A(I,K)*B(K,J)
760     NEXT K
770     RES(I,J)=SUM
780   NEXT J
790 NEXT I
800 PRINT : PRINT "RESULT OF MULTIPLICATION:"
810 GOSUB 930
820 RETURN

910 REM --- DISPLAY MATRIX A ---
911 FOR I=1 TO R1
912   FOR J=1 TO C1
913     PRINT A(I,J);" ";
914   NEXT J
915   PRINT
916 NEXT I
917 RETURN

920 REM --- DISPLAY MATRIX B ---
921 FOR I=1 TO R2
922   FOR J=1 TO C2
923     PRINT B(I,J);" ";
924   NEXT J
925   PRINT
926 NEXT I
927 RETURN

930 REM --- DISPLAY RESULT MATRIX ---
931 FOR I=1 TO R1
932   FOR J=1 TO C2
933     PRINT RES(I,J);" ";
934   NEXT J
935   PRINT
936 NEXT I
937 RETURN
